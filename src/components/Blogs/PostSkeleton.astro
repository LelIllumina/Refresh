---
import type { InferEntrySchema } from "astro:content";
import type { RenderedContent } from "astro:content";
import { render } from "astro:content";
import FigureImage from "@components/FigureImage.astro";

interface Props {
  post: {
    id: string;
    body?: string;
    collection: "blogs" | "guides";
    data: InferEntrySchema<"blogs" | "guides">;
    rendered?: RenderedContent;
    filePath?: string;
  };
}

const { post } = Astro.props;
const { title, date, thumb } = post.data;

const { Content } = await render(post);

const background = `url(${thumb.src})`;
---

<main>
  <article>
    <header>
      <div class="background"></div>
      <div class="brand">
        <h1>
          LEL <br /> DOT <br />
          <span>NEKOWEB</span>
        </h1>
      </div>
      <div class="title">
        <time datetime={date.toISOString()}>
          <h2>
            EPISODE: {date.toLocaleDateString()}
          </h2>
        </time>
        <h2>{title}</h2>
      </div>
    </header>
    <section>
      <Content components={{ img: FigureImage }} />
    </section>
  </article>
</main>

<style define:vars={{ background }}>
  header {
    height: 100vh;
    padding-inline: clamp(2rem, 15vw, 10rem);
    text-align: center;

    .background {
      position: absolute;
      z-index: -1;
      inset: 0;

      width: 100%;
      height: 100vh;

      background-image: var(--background);
      background-attachment: fixed;
      background-position: center;
      background-size: cover;

      mask-image: linear-gradient(#000000c9, #0000);
    }

    .brand {
      margin-block: 2rem;
      font-weight: 900;
      text-align: start;

      h1 {
        margin: 0;
        font-size: clamp(3rem, 50vh / 3, 20rem);

        span {
          display: block;
          font-size: clamp(6rem, 20vh, 40rem);
        }
      }
    }

    .title {
      h2 {
        margin: 0;
        font-size: clamp(2rem, 30vh / 3, 15rem);
        font-weight: 900;
        text-align: end;

        time & {
          text-align: start;
        }
      }
    }
  }

  section {
    max-width: 70ch;
    margin: auto;
    padding: 2rem;

    figure {
      text-align: center;

      img {
        width: auto;
        max-width: 20vw;
        max-height: 50vh;
        margin-block: 1rem;
        margin-inline: auto;
        border-radius: 0.5rem;
      }
    }
  }
</style>
